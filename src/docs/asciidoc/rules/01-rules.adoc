[[rules-code]]
= Reglas

Una breve descripción de que son las reglas en AML


ifndef::imagesdir[:imagesdir: images]
ifndef::sourcedir[:sourcedir: ../java]
ifndef::queriesdir[:queriesdir: queries/]
ifndef::qryutilsdir[:qryutilsdir: qry-utils/]
ifndef::params[:params: parametros/]


== Parámetros

Los parámetros de cada una de las reglas configuradas a nivel de base de datos se pueden consultar con la siguiente manera

[source,sql,linenums,options="nowrap"]
[subs="verbatim,quotes"]
----
include::{qryutilsdir}parametros.sql[indent=2]
----

<1> Esquema de Base de datos
<2> Identificador de la regla


[TIP]
====
Esquemas validos de aml:

* MELTSAN
* BANCA
* SOFOM
* TD
====

// .....................................................................................................
== R200x - Inusual por patrón monto

Regla por monto inusual detectado

- La regla 200 para cierto cliente tuvo que ser modificada generando reglas 200x, es decir para reglas con ids mayores a 2000 se ejecuta la sentencia SQL para obten
    * Donde la regla **200x** es para vaidar operaciones con montos mayores a 50 millones para personas morales `(Directas e indirectas 2, 104)` y de un millón para personas físicas `(Indirectas - 103)` y
    * Donde la regla **200y** es para validar operaciones con montos mayores a 7 millones para personas morales `(Directas e indirectas 2, 104)` y de 300 mil para personas físicas `(Indirectas - 103)`

[source,sql,linenums,indent=0,subs="verbatim,quotes",role="primary"]
.R-200x
----
include::{queriesdir}R200-x.sql[indent=0]
----
<1> Fecha inicio de análisis y fecha fin de análisis
<2> Instrumento monetarion
<3> Tipo de operacion
<4> Tipo de orden
<5> Tipo de persona
<6> Monto en pesos
<7> Idenntificador de la regla de negocio, en este caso 200x

[source,sql,linenums,indent=0,subs="verbatim,quotes",role="secondary"]
.R-200y
----
include::{queriesdir}R200-y.sql[indent=0]
----

<1> Fecha inicio de análisis y fecha fin de análisis, ejemplo `2020-10-22 00:26:09.603`
<2> Instrumento monetarion
<3> Tipo de operacion
<4> Tipo de orden
<5> Tipo de persona
<6> Monto en pesos
<7> Idenntificador de la regla de negocio, en este caso 200y

[TIP]
====
Podemos encontrar los parámetros 2,3,4,5 en los catálogos del sistema
`select * from esta pinche tabla`
====

// // .....................................................................................................
// === 201 - REGLA INUSUAL POR PATRÓN NÚMERO DE TRANSACCIONES


// ==== Parámetros de la regla

// include::{params}/param-R201.adoc[]


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}201-regla-inusual-por-patron-numero-de-transacciones.sql[indent=0]
// ----

// // <1> Monto a considerar espresado en usd



// // .....................................................................................................
// === 202 - REGLA INUSUAL POR PATRÓN FUNCIONARIO


// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}202-regla-inusual-por-patron-funcionario.sql[indent=0]
// ----




// // .....................................................................................................
// === 203 - REGLA INUSUAL POR PATRÓN FECHA


// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}203-regla-inusual-por-patron-fecha.sql[indent=0]
// ----

// // .....................................................................................................
// === 204 - REGLA INUSUAL POR PATRÓN HORA


// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}204-regla-inusual-por-patron-hora.sql[indent=0]
// ----



// === 205 - REGLA INUSUAL POR PATRÓN GEOGRAFÍA/SUCURSAL

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}205-regla-inusual-por-patron-geografia-sucursal.sql[indent=0]
// ----


// === 206 - REGLA INUSUAL POR PATRÓN DEPOSITANTE/BENEFICIARIO

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}206-regla-inusual-por-patron-depositante-beneficiario.sql[indent=0]
// ----


// === 207 - REGLA INUSUAL POR PATRÓN TASA

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}207-regla-inusual-por-patron-tasa.sql[indent=0]
// ----


// === 208 - REGLA OPERACIONES RELEVANTES

// ==== Parámetros de la regla

// include::{params}/param-R208.adoc[]


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}208-regla-operaciones-relevantes.sql[indent=0]
// ----


// === 209 - REGLA OPERACIONES FRACCIONADAS

// ==== Parámetros de la regla

// include::{params}/param-R209.adoc[]


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}209-regla-operaciones-fraccionadas.sql[indent=0]
// ----


// === 210 - REGLA ALERTAS TEMPRANAS

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}210-regla-alertas-tempranas.sql[indent=0]
// ----


// === 211 - REGLA EFECTIVO EN DÓLARES

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}211-regla-efectivo-en-dolares.sql[indent=0]
// ----


// === 212 - REGLA TRANSFERENCIAS INTERNACIONALES

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}212-regla-transferencias-internacionales.sql[indent=0]
// ----


// === 213 - REGLA TRANSFERENCIAS INTERNACIONALES

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}213-regla-transferencias-internacionales.sql[indent=0]
// ----


// === 214 - REGLA OPERACIONES RELEVANTES terceros

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}214-regla-operaciones-relevantes-terceros.sql[indent=0]
// ----


// === 215 - REGLA EVASIÓN DE PARÁMETROS

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}215-regla-evasion-de-parametros.sql[indent=0]
// ----


// === 216 - REGLA MONTOS INUSUALMENTE ELEVADOS

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}216-regla-montos-inusualmente-elevados.sql[indent=0]
// ----


// === 217 - REGLA OPERACIONES FRACCIONADAS

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}217-regla-operaciones-fraccionadas.sql[indent=0]
// ----


// === 218 - REGLA COINCIDENCIA EN LISTAS NEGRAS

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}218-regla-coincidencia-en-listas-negras.sql[indent=0]
// ----


// === 219 - REGLA PAÍSES SANCIONADOS

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}219-regla-paises-sancionados.sql[indent=0]
// ----


// === 220 - REGLA DESVIACIÓN ACTIVIDAD DEL CLIENTE

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}220-regla-desviacion-actividad-del-cliente.sql[indent=0]
// ----


// === 221 - RÁPIDO MOVIMIENTO DE FONDOS

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}221-rapido-movimiento-de-fondos.sql[indent=0]
// ----


// === 222 - LIQUIDACIÓN ANTICIPADA DE CRÉDITO

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}222-liquidacion-anticipada-de-credito.sql[indent=0]
// ----


// === 223 - PAGO EN EFECTIVO TARJETA DE CRÉDITO

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}223-pago-en-efectivo-tarjeta-de-credito.sql[indent=0]
// ----


// === 224 - TRANSACCIONES PEPS

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}224-transacciones-peps.sql[indent=0]
// ----


// === 225 - REGLA MONTOS ELEVADOS Y RETIROS PARCIALES

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}225-regla-montos-elevados-y-retiros-parciales.sql[indent=0]
// ----


// === 226 - REGLA APORTACIONES PARCIALES Y RETIROS ELEVADOS

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}226-regla-aportaciones-parciales-y-retiros-elevados.sql[indent=0]
// ----


// === 227 - GARANTÍA RECURRENTE

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}227-garantia-recurrente.sql[indent=0]
// ----


// === 228 - VALOR DE LA GARANTÍA NO ACORDE CON LOS INGRESOS

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}228-valor-de-la-garantia-no-acorde-con-los-ingresos.sql[indent=0]
// ----


// === 229 - DOMICILIOS IGUALES

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}229-domicilios-iguales.sql[indent=0]
// ----


// === 230 - CLIENTES SIN ACTIVIDAD ECONÓMICA

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}230-clientes-sin-actividad-economica.sql[indent=0]
// ----


// === 231 - INVERSIÓN INICIAL NO ACORDE A LOS INGRESOS Y ACTIVIDAD DECLARADA

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}231-inversion-inicial-no-acorde-a-los-ingresos-y-actividad-declarada.sql[indent=0]
// ----


// === 232 - APERTURA DE MÚLTIPLES CUENTAS

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}232-apertura-de-multiples-cuentas.sql[indent=0]
// ----


// === 233 - SOBRE PAGO DE TARJETA DE CRÉDITO

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}233-sobre-pago-de-tarjeta-de-credito.sql[indent=0]
// ----


// === 234 - PAGOS TOTALES O PARCIALES POR TERCERAS PERSONAS

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}234-pagos-totales-o-parciales-por-terceras-personas.sql[indent=0]
// ----


// === 235 - PAGO A TARJETAS DE DISTINTOS CLIENTES POR UNA MISMA PERSONA O CUENTA

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}235-pago-a-tarjetas-de-distintos-clientes-por-una-misma-persona-o-cuenta.sql[indent=0]
// ----


// === 236 - VEHÍCULO DE LUJO

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}236-vehiculo-de-lujo.sql[indent=0]
// ----


// === 237 - ALTO VOLUMEN DE APORTACIONES MISMO DÍA

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}237-alto-volumen-de-aportaciones-mismo-dia.sql[indent=0]
// ----


// === 238 - ALERTA DE INUSUALIDAD: TRANSFERENCIAS INTERNACIONALES DIFERENTES BENEFICIARIOS

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}238-alerta-de-inusualidad-transferencias-internacionales-diferentes-beneficiarios.sql[indent=0]
// ----


// === 239 - ALERTA DE INUSUALIDAD - MÚLTIPLES DEPÓSITOS TRANSFERIDOS INTERNACIONALMENTE

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}239-alerta-de-inusualidad-multiples-depositos-transferidos-internacionalmente.sql[indent=0]
// ----


// === 240 - ALERTA DE INUSUALIDAD - MÚLTIPLES Y ELEVADAS TRANSFERENCIAS INTERNACIONALES

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}240-alerta-de-inusualidad-multiples-y-elevadas-transferencias-internacionales.sql[indent=0]
// ----


// === 241 - ALERTA DE INUSUALIDAD - LIQUIDACIÓN ANTICIPADA DE CRÉDITO

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}241-alerta-de-inusualidad-liquidacion-anticipada-de-credito.sql[indent=0]
// ----


// === 242 - ALERTA DE INUSUALIDAD - SPID

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}242-alerta-de-inusualidad-spid.sql[indent=0]
// ----


// === 243 - ALERTA DE INUSUALIDAD - CAMBIO EN EL PERFIL TRANSACCIONAL

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}243-alerta-de-inusualidad-cambio-en-el-perfil-transaccional.sql[indent=0]
// ----


// === 244 - ALERTA DE INUSUALIDAD - MISMOS ACCIONISTAS EN DIFERENTES EMPRESAS

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}244-alerta-de-inusualidad-mismos-accionistas-en-diferentes-empresas.sql[indent=0]
// ----


// === 245 - CAMBIO EN PERFIL TRANSACCIONAL PEP

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}245-cambio-en-perfil-transaccional-pep.sql[indent=0]
// ----


// === 246 - CAMBIO EN PERFIL TRANSACCIONAL CAR

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}246-cambio-en-perfil-transaccional-car.sql[indent=0]
// ----


// === 247 - CAMBIO EN PERFIL TRANSACCIONAL RIESGO MEDIO

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}247-cambio-en-perfil-transaccional-riesgo-medio.sql[indent=0]
// ----


// === 248 - ALERTA DE INUSUALIDAD - ELEVADOS PAGOS DE PARCIALIDADES DE CRÉDITO 

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}248-alerta-de-inusualidad-elevados-pagos-de-parcialidades-de-credito-.sql[indent=0]
// ----


// === 249 - ALERTA SPID - TRANSFERENCIAS CUENTA PUENTE

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}249-alerta-spid-transferencias-cuenta-puente.sql[indent=0]
// ----


// === 250 - REGLA INUSUAL POR PATRÓN MONTO TIPO DISPOSICIÓN EN PESOS

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}250-regla-inusual-por-patron-monto-tipo-disposicion-en-pesos.sql[indent=0]
// ----


// === 251 - REGLA INUSUAL POR PATRÓN NÚMERO DE TRANSACCIONES DISPOSICIÓN

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}251-regla-inusual-por-patron-numero-de-transacciones-disposicion.sql[indent=0]
// ----


// === 252 - REGLA EFECTIVO FISICAS SEGUNDO PARRAFO DISP. 14 

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}252-regla-efectivo-fisicas-segundo-parrafo-disp.-14-.sql[indent=0]
// ----


// === 253 - REGLA EFECTIVO MORALES  SEGUNDO PARRAFO DISP. 14 

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}253-regla-efectivo-morales-segundo-parrafo-disp.-14-.sql[indent=0]
// ----


// === 254 - REGLA RETIROS EN VENTANILLA 

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}254-regla-retiros-en-ventanilla-.sql[indent=0]
// ----


// === 255 - ACUMULADO DE OPERACIONES DIARIAS BANCA

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}255-acumulado-de-operaciones-diarias-banca.sql[indent=0]
// ----


// === 256 - ACUMULADO DE OPERACIONES MENSUALES BANCA

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}200-regla-inusual-por-patron-monto-v1.sql[indent=0]
// ----


// === 257 - MONTOS ELEVADOS BANCA

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}200-regla-inusual-por-patron-monto-v1.sql[indent=0]
// ----


// === 299 -  REGLA CAMBIO DE DEMOGRAFICOS E INCREMENTO DE NIVEL DE RIESGO

// ==== Parámetros de la regla


// [source,sql,linenums,options="nowrap"]
// [subs="verbatim,quotes"]
// ----
// include::{queriesdir}200-regla-inusual-por-patron-monto-v1.sql[indent=0]
// ----


